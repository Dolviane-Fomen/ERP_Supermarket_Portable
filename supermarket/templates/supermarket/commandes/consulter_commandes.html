<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consulter les Commandes</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #06beb6 0%, #48b1bf 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #06beb6 0%, #48b1bf 100%);
            color: white;
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .header h1 {
            font-size: 1.8em;
            margin: 0;
        }
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .btn-primary {
            background: #28a745;
            color: white;
        }
        .btn-primary:hover {
            background: #218838;
            transform: translateY(-2px);
        }
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        .btn-secondary:hover {
            background: #5a6268;
        }
        .btn-info {
            background: #17a2b8;
            color: white;
        }
        .btn-info:hover {
            background: #138496;
        }
        .btn-danger {
            background: #dc3545;
            color: white;
        }
        .btn-danger:hover {
            background: #c82333;
        }
        .content {
            padding: 30px;
        }
        .filters {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        .filter-group {
            display: flex;
            flex-direction: column;
        }
        .filter-group label {
            margin-bottom: 5px;
            color: #2c3e50;
            font-weight: 600;
            font-size: 0.9em;
        }
        .filter-group input,
        .filter-group select {
            padding: 10px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 1em;
        }
        .filter-group input:focus,
        .filter-group select:focus {
            outline: none;
            border-color: #06beb6;
            box-shadow: 0 0 0 3px rgba(6, 190, 182, 0.1);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e1e8ed;
        }
        th {
            background-color: #f8f9fa;
            color: #2c3e50;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85em;
        }
        tr:hover {
            background-color: #f8f9fa;
        }
        .badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            color: white;
        }
        .badge-success { background: #28a745; }
        .badge-danger { background: #dc3545; }
        .badge-info { background: #17a2b8; }
        .badge-warning { background: #ffc107; color: #212529; }
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .empty-state {
            text-align: center;
            padding: 40px;
            color: #6c757d;
        }
        .empty-state i {
            font-size: 3em;
            margin-bottom: 10px;
        }
    @media (max-width: 768px) {
        body { padding: 10px; }
        .header {
            flex-direction: column;
            align-items: flex-start;
            padding: 15px;
        }
        .header h1 {
            font-size: 1.4em;
            margin-bottom: 10px;
        }
        .content {
            padding: 15px;
        }
        .filters {
            grid-template-columns: 1fr;
            padding: 15px;
        }
        .table-container {
            overflow-x: auto;
            padding: 10px;
        }
        table {
            min-width: 800px;
        }
        th, td {
            padding: 10px;
            font-size: 0.9em;
        }
        .action-buttons {
            flex-direction: column;
            gap: 5px;
        }
        .btn {
            width: 100%;
            padding: 10px;
            font-size: 0.9em;
        }
    }
    
    @media (max-width: 480px) {
        body { padding: 5px; }
        .header {
            padding: 10px;
        }
        .header h1 {
            font-size: 1.2em;
        }
        .content {
            padding: 10px;
        }
        .filters {
            padding: 10px;
        }
        th, td {
            padding: 8px;
            font-size: 0.85em;
        }
        .btn {
            padding: 8px;
            font-size: 0.85em;
        }
    }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-list"></i> Consulter les Commandes</h1>
            <div>
                <a href="{% url 'enregistrer_commande' %}" class="btn btn-primary">
                    <i class="fas fa-plus"></i> Nouvelle Commande
                </a>
                <a href="{% url 'dashboard_commandes' %}" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> Retour
                </a>
            </div>
        </div>
        <div class="content">
            {% if messages %}
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }}">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}

            <form method="GET" class="filters">
                <div class="filter-group">
                    <label>Recherche</label>
                    <input type="text" name="search" value="{{ search_query }}" placeholder="Client, article...">
                </div>
                <div class="filter-group">
                    <label>État</label>
                    <select name="etat">
                        <option value="">Tous</option>
                        <option value="en_attente" {% if etat_filter == 'en_attente' %}selected{% endif %}>En attente</option>
                        <option value="en_livraison" {% if etat_filter == 'en_livraison' %}selected{% endif %}>En livraison</option>
                        <option value="livree" {% if etat_filter == 'livree' %}selected{% endif %}>Livrée</option>
                        <option value="annulee" {% if etat_filter == 'annulee' %}selected{% endif %}>Annulée</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Date début</label>
                    <input type="date" name="date_debut" value="{{ date_debut }}">
                </div>
                <div class="filter-group">
                    <label>Date fin</label>
                    <input type="date" name="date_fin" value="{{ date_fin }}">
                </div>
                <div class="filter-group" style="display: flex; align-items: flex-end;">
                    <button type="submit" class="btn btn-primary" style="width: 100%;">
                        <i class="fas fa-search"></i> Filtrer
                    </button>
                </div>
            </form>

            {% if commandes %}
            <div style="margin-bottom: 15px; padding: 10px; background: #e7f3ff; border-radius: 5px; color: #0066cc;">
                <strong>Nombre de commandes (documents) affichées: {{ commandes|length }}</strong>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Date/Heure</th>
                        <th>Client</th>
                        <th>Nombre d'articles</th>
                        <th>Quantité totale</th>
                        <th>Prix total</th>
                        <th>État</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for groupe in commandes %}
                    <tr>
                        <td>
                            {{ groupe.date|date:"d/m/Y" }}<br>
                            <small>{{ groupe.heure|time:"H:i" }}</small>
                        </td>
                        <td>{{ groupe.client.intitule }}</td>
                        <td>{{ groupe.nombre_articles }}</td>
                        <td>{{ groupe.quantite_totale|floatformat:2 }}</td>
                        <td>{{ groupe.prix_total|floatformat:0 }} FCFA</td>
                        <td>
                            <span class="badge badge-{% if groupe.etat_commande == 'livree' %}success{% elif groupe.etat_commande == 'annulee' %}danger{% elif groupe.etat_commande == 'en_livraison' %}info{% elif groupe.etat_commande == 'validee' %}success{% else %}warning{% endif %}">
                                {% if groupe.etat_commande == 'en_attente' %}En attente
                                {% elif groupe.etat_commande == 'en_livraison' %}En livraison
                                {% elif groupe.etat_commande == 'livree' %}Livrée
                                {% elif groupe.etat_commande == 'annulee' %}Annulée
                                {% elif groupe.etat_commande == 'validee' %}Validée
                                {% else %}{{ groupe.etat_commande }}{% endif %}
                            </span>
                        </td>
                        <td>
                            <a href="{% url 'detail_commande' groupe.id %}" class="btn btn-info" style="padding: 5px 10px; font-size: 0.85em;">
                                <i class="fas fa-eye"></i> Voir
                            </a>
                            <a href="{% url 'modifier_commande' groupe.id %}" class="btn btn-primary" style="padding: 5px 10px; font-size: 0.85em;">
                                <i class="fas fa-edit"></i> Modifier
                            </a>
                            <button class="btn btn-danger delete-btn" style="padding: 5px 10px; font-size: 0.85em;" 
                                    data-commande-id="{{ groupe.id }}" 
                                    data-client-name="{{ groupe.client.intitule|escapejs }}" 
                                    data-commande-date="{{ groupe.date|date:'d/m/Y' }}">
                                <i class="fas fa-trash"></i> Supprimer
                            </button>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <div class="empty-state">
                <i class="fas fa-shopping-cart"></i>
                <p>Aucune commande trouvée</p>
            </div>
            {% endif %}
        </div>
    </div>

<!-- Modal de confirmation de suppression -->
<div id="deleteModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; align-items: center; justify-content: center;">
    <div style="background: white; border-radius: 15px; padding: 30px; max-width: 500px; width: 90%; box-shadow: 0 10px 30px rgba(0,0,0,0.3);">
        <h3 style="color: #dc3545; margin-bottom: 15px;">
            <i class="fas fa-exclamation-triangle"></i> Confirmer la suppression
        </h3>
        <p style="margin-bottom: 10px;">Êtes-vous sûr de vouloir supprimer la commande du client <strong id="clientName"></strong> du <strong id="commandeDate"></strong> ?</p>
        <p style="color: #dc3545; font-weight: 600; margin-bottom: 20px;">Cette action est irréversible !</p>
        <div style="display: flex; gap: 10px; justify-content: flex-end;">
            <button onclick="closeDeleteModal()" class="btn btn-secondary" style="padding: 10px 20px;">Annuler</button>
            <form id="deleteForm" method="POST" style="display: inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger" style="padding: 10px 20px;">
                    <i class="fas fa-trash"></i> Supprimer
                </button>
            </form>
        </div>
    </div>
</div>

<script>
function confirmDelete(commandeId, clientName, commandeDate) {
    document.getElementById('clientName').textContent = clientName;
    document.getElementById('commandeDate').textContent = commandeDate;
    document.getElementById('deleteForm').action = "{% url 'supprimer_commande' 0 %}".replace('0', commandeId);
    document.getElementById('deleteModal').style.display = 'flex';
}

function closeDeleteModal() {
    document.getElementById('deleteModal').style.display = 'none';
}

// Fermer le modal en cliquant en dehors
document.getElementById('deleteModal')?.addEventListener('click', function(e) {
    if (e.target === this) {
        closeDeleteModal();
    }
});

// Attacher les événements de suppression aux boutons
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.delete-btn').forEach(function(btn) {
        btn.addEventListener('click', function() {
            var commandeId = this.getAttribute('data-commande-id');
            var clientName = this.getAttribute('data-client-name');
            var commandeDate = this.getAttribute('data-commande-date');
            confirmDelete(commandeId, clientName, commandeDate);
        });
    });
});
</script>
</body>
</html>



    <div class="container">

        <div class="header">

            <h1><i class="fas fa-list"></i> Consulter les Commandes</h1>

            <div>

                <a href="{% url 'enregistrer_commande' %}" class="btn btn-primary">

                    <i class="fas fa-plus"></i> Nouvelle Commande

                </a>

                <a href="{% url 'dashboard_commandes' %}" class="btn btn-secondary">

                    <i class="fas fa-arrow-left"></i> Retour

                </a>

            </div>

        </div>

        <div class="content">

            {% if messages %}

                {% for message in messages %}

                    <div class="alert alert-{{ message.tags }}">

                        {{ message }}

                    </div>

                {% endfor %}

            {% endif %}



            <form method="GET" class="filters">

                <div class="filter-group">

                    <label>Recherche</label>

                    <input type="text" name="search" value="{{ search_query }}" placeholder="Client, article...">

                </div>

                <div class="filter-group">

                    <label>État</label>

                    <select name="etat">

                        <option value="">Tous</option>

                        <option value="en_attente" {% if etat_filter == 'en_attente' %}selected{% endif %}>En attente</option>

                        <option value="en_livraison" {% if etat_filter == 'en_livraison' %}selected{% endif %}>En livraison</option>

                        <option value="livree" {% if etat_filter == 'livree' %}selected{% endif %}>Livrée</option>

                        <option value="annulee" {% if etat_filter == 'annulee' %}selected{% endif %}>Annulée</option>

                    </select>

                </div>

                <div class="filter-group">

                    <label>Date début</label>

                    <input type="date" name="date_debut" value="{{ date_debut }}">

                </div>

                <div class="filter-group">

                    <label>Date fin</label>

                    <input type="date" name="date_fin" value="{{ date_fin }}">

                </div>

                <div class="filter-group" style="display: flex; align-items: flex-end;">

                    <button type="submit" class="btn btn-primary" style="width: 100%;">

                        <i class="fas fa-search"></i> Filtrer

                    </button>

                </div>

            </form>



            {% if commandes %}

            <div style="margin-bottom: 15px; padding: 10px; background: #e7f3ff; border-radius: 5px; color: #0066cc;">

                <strong>Nombre de commandes (documents) affichées: {{ commandes|length }}</strong>

            </div>

            <table>

                <thead>

                    <tr>

                        <th>Date/Heure</th>

                        <th>Client</th>

                        <th>Nombre d'articles</th>

                        <th>Quantité totale</th>

                        <th>Prix total</th>

                        <th>État</th>

                        <th>Actions</th>

                    </tr>

                </thead>

                <tbody>

                    {% for groupe in commandes %}

                    <tr>

                        <td>

                            {{ groupe.date|date:"d/m/Y" }}<br>

                            <small>{{ groupe.heure|time:"H:i" }}</small>

                        </td>

                        <td>{{ groupe.client.intitule }}</td>

                        <td>{{ groupe.nombre_articles }}</td>

                        <td>{{ groupe.quantite_totale|floatformat:2 }}</td>

                        <td>{{ groupe.prix_total|floatformat:0 }} FCFA</td>

                        <td>

                            <span class="badge badge-{% if groupe.etat_commande == 'livree' %}success{% elif groupe.etat_commande == 'annulee' %}danger{% elif groupe.etat_commande == 'en_livraison' %}info{% elif groupe.etat_commande == 'validee' %}success{% else %}warning{% endif %}">

                                {% if groupe.etat_commande == 'en_attente' %}En attente

                                {% elif groupe.etat_commande == 'en_livraison' %}En livraison

                                {% elif groupe.etat_commande == 'livree' %}Livrée

                                {% elif groupe.etat_commande == 'annulee' %}Annulée

                                {% elif groupe.etat_commande == 'validee' %}Validée

                                {% else %}{{ groupe.etat_commande }}{% endif %}

                            </span>

                        </td>

                        <td>

                            <a href="{% url 'detail_commande' groupe.id %}" class="btn btn-info" style="padding: 5px 10px; font-size: 0.85em;">

                                <i class="fas fa-eye"></i> Voir

                            </a>

                            <a href="{% url 'modifier_commande' groupe.id %}" class="btn btn-primary" style="padding: 5px 10px; font-size: 0.85em;">

                                <i class="fas fa-edit"></i> Modifier

                            </a>

                            <button class="btn btn-danger delete-btn" style="padding: 5px 10px; font-size: 0.85em;" 

                                    data-commande-id="{{ groupe.id }}" 

                                    data-client-name="{{ groupe.client.intitule|escapejs }}" 

                                    data-commande-date="{{ groupe.date|date:'d/m/Y' }}">

                                <i class="fas fa-trash"></i> Supprimer

                            </button>

                        </td>

                    </tr>

                    {% endfor %}

                </tbody>

            </table>

            {% else %}

            <div class="empty-state">

                <i class="fas fa-shopping-cart"></i>

                <p>Aucune commande trouvée</p>

            </div>

            {% endif %}

        </div>

    </div>



<!-- Modal de confirmation de suppression -->

<div id="deleteModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; align-items: center; justify-content: center;">

    <div style="background: white; border-radius: 15px; padding: 30px; max-width: 500px; width: 90%; box-shadow: 0 10px 30px rgba(0,0,0,0.3);">

        <h3 style="color: #dc3545; margin-bottom: 15px;">

            <i class="fas fa-exclamation-triangle"></i> Confirmer la suppression

        </h3>

        <p style="margin-bottom: 10px;">Êtes-vous sûr de vouloir supprimer la commande du client <strong id="clientName"></strong> du <strong id="commandeDate"></strong> ?</p>

        <p style="color: #dc3545; font-weight: 600; margin-bottom: 20px;">Cette action est irréversible !</p>

        <div style="display: flex; gap: 10px; justify-content: flex-end;">

            <button onclick="closeDeleteModal()" class="btn btn-secondary" style="padding: 10px 20px;">Annuler</button>

            <form id="deleteForm" method="POST" style="display: inline;">

                {% csrf_token %}

                <button type="submit" class="btn btn-danger" style="padding: 10px 20px;">

                    <i class="fas fa-trash"></i> Supprimer

                </button>

            </form>

        </div>

    </div>

</div>



<script>

function confirmDelete(commandeId, clientName, commandeDate) {

    document.getElementById('clientName').textContent = clientName;

    document.getElementById('commandeDate').textContent = commandeDate;

    document.getElementById('deleteForm').action = "{% url 'supprimer_commande' 0 %}".replace('0', commandeId);

    document.getElementById('deleteModal').style.display = 'flex';

}



function closeDeleteModal() {

    document.getElementById('deleteModal').style.display = 'none';

}



// Fermer le modal en cliquant en dehors

document.getElementById('deleteModal')?.addEventListener('click', function(e) {

    if (e.target === this) {

        closeDeleteModal();

    }

});



// Attacher les événements de suppression aux boutons

document.addEventListener('DOMContentLoaded', function() {

    document.querySelectorAll('.delete-btn').forEach(function(btn) {

        btn.addEventListener('click', function() {

            var commandeId = this.getAttribute('data-commande-id');

            var clientName = this.getAttribute('data-client-name');

            var commandeDate = this.getAttribute('data-commande-date');

            confirmDelete(commandeId, clientName, commandeDate);

        });

    });

});

</script>

</body>

</html>






    <div class="container">

        <div class="header">

            <h1><i class="fas fa-list"></i> Consulter les Commandes</h1>

            <div>

                <a href="{% url 'enregistrer_commande' %}" class="btn btn-primary">

                    <i class="fas fa-plus"></i> Nouvelle Commande

                </a>

                <a href="{% url 'dashboard_commandes' %}" class="btn btn-secondary">

                    <i class="fas fa-arrow-left"></i> Retour

                </a>

            </div>

        </div>

        <div class="content">

            {% if messages %}

                {% for message in messages %}

                    <div class="alert alert-{{ message.tags }}">

                        {{ message }}

                    </div>

                {% endfor %}

            {% endif %}



            <form method="GET" class="filters">

                <div class="filter-group">

                    <label>Recherche</label>

                    <input type="text" name="search" value="{{ search_query }}" placeholder="Client, article...">

                </div>

                <div class="filter-group">

                    <label>État</label>

                    <select name="etat">

                        <option value="">Tous</option>

                        <option value="en_attente" {% if etat_filter == 'en_attente' %}selected{% endif %}>En attente</option>

                        <option value="en_livraison" {% if etat_filter == 'en_livraison' %}selected{% endif %}>En livraison</option>

                        <option value="livree" {% if etat_filter == 'livree' %}selected{% endif %}>Livrée</option>

                        <option value="annulee" {% if etat_filter == 'annulee' %}selected{% endif %}>Annulée</option>

                    </select>

                </div>

                <div class="filter-group">

                    <label>Date début</label>

                    <input type="date" name="date_debut" value="{{ date_debut }}">

                </div>

                <div class="filter-group">

                    <label>Date fin</label>

                    <input type="date" name="date_fin" value="{{ date_fin }}">

                </div>

                <div class="filter-group" style="display: flex; align-items: flex-end;">

                    <button type="submit" class="btn btn-primary" style="width: 100%;">

                        <i class="fas fa-search"></i> Filtrer

                    </button>

                </div>

            </form>



            {% if commandes %}

            <div style="margin-bottom: 15px; padding: 10px; background: #e7f3ff; border-radius: 5px; color: #0066cc;">

                <strong>Nombre de commandes (documents) affichées: {{ commandes|length }}</strong>

            </div>

            <table>

                <thead>

                    <tr>

                        <th>Date/Heure</th>

                        <th>Client</th>

                        <th>Nombre d'articles</th>

                        <th>Quantité totale</th>

                        <th>Prix total</th>

                        <th>État</th>

                        <th>Actions</th>

                    </tr>

                </thead>

                <tbody>

                    {% for groupe in commandes %}

                    <tr>

                        <td>

                            {{ groupe.date|date:"d/m/Y" }}<br>

                            <small>{{ groupe.heure|time:"H:i" }}</small>

                        </td>

                        <td>{{ groupe.client.intitule }}</td>

                        <td>{{ groupe.nombre_articles }}</td>

                        <td>{{ groupe.quantite_totale|floatformat:2 }}</td>

                        <td>{{ groupe.prix_total|floatformat:0 }} FCFA</td>

                        <td>

                            <span class="badge badge-{% if groupe.etat_commande == 'livree' %}success{% elif groupe.etat_commande == 'annulee' %}danger{% elif groupe.etat_commande == 'en_livraison' %}info{% elif groupe.etat_commande == 'validee' %}success{% else %}warning{% endif %}">

                                {% if groupe.etat_commande == 'en_attente' %}En attente

                                {% elif groupe.etat_commande == 'en_livraison' %}En livraison

                                {% elif groupe.etat_commande == 'livree' %}Livrée

                                {% elif groupe.etat_commande == 'annulee' %}Annulée

                                {% elif groupe.etat_commande == 'validee' %}Validée

                                {% else %}{{ groupe.etat_commande }}{% endif %}

                            </span>

                        </td>

                        <td>

                            <a href="{% url 'detail_commande' groupe.id %}" class="btn btn-info" style="padding: 5px 10px; font-size: 0.85em;">

                                <i class="fas fa-eye"></i> Voir

                            </a>

                            <a href="{% url 'modifier_commande' groupe.id %}" class="btn btn-primary" style="padding: 5px 10px; font-size: 0.85em;">

                                <i class="fas fa-edit"></i> Modifier

                            </a>

                            <button class="btn btn-danger delete-btn" style="padding: 5px 10px; font-size: 0.85em;" 

                                    data-commande-id="{{ groupe.id }}" 

                                    data-client-name="{{ groupe.client.intitule|escapejs }}" 

                                    data-commande-date="{{ groupe.date|date:'d/m/Y' }}">

                                <i class="fas fa-trash"></i> Supprimer

                            </button>

                        </td>

                    </tr>

                    {% endfor %}

                </tbody>

            </table>

            {% else %}

            <div class="empty-state">

                <i class="fas fa-shopping-cart"></i>

                <p>Aucune commande trouvée</p>

            </div>

            {% endif %}

        </div>

    </div>



<!-- Modal de confirmation de suppression -->

<div id="deleteModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; align-items: center; justify-content: center;">

    <div style="background: white; border-radius: 15px; padding: 30px; max-width: 500px; width: 90%; box-shadow: 0 10px 30px rgba(0,0,0,0.3);">

        <h3 style="color: #dc3545; margin-bottom: 15px;">

            <i class="fas fa-exclamation-triangle"></i> Confirmer la suppression

        </h3>

        <p style="margin-bottom: 10px;">Êtes-vous sûr de vouloir supprimer la commande du client <strong id="clientName"></strong> du <strong id="commandeDate"></strong> ?</p>

        <p style="color: #dc3545; font-weight: 600; margin-bottom: 20px;">Cette action est irréversible !</p>

        <div style="display: flex; gap: 10px; justify-content: flex-end;">

            <button onclick="closeDeleteModal()" class="btn btn-secondary" style="padding: 10px 20px;">Annuler</button>

            <form id="deleteForm" method="POST" style="display: inline;">

                {% csrf_token %}

                <button type="submit" class="btn btn-danger" style="padding: 10px 20px;">

                    <i class="fas fa-trash"></i> Supprimer

                </button>

            </form>

        </div>

    </div>

</div>



<script>

function confirmDelete(commandeId, clientName, commandeDate) {

    document.getElementById('clientName').textContent = clientName;

    document.getElementById('commandeDate').textContent = commandeDate;

    document.getElementById('deleteForm').action = "{% url 'supprimer_commande' 0 %}".replace('0', commandeId);

    document.getElementById('deleteModal').style.display = 'flex';

}



function closeDeleteModal() {

    document.getElementById('deleteModal').style.display = 'none';

}



// Fermer le modal en cliquant en dehors

document.getElementById('deleteModal')?.addEventListener('click', function(e) {

    if (e.target === this) {

        closeDeleteModal();

    }

});



// Attacher les événements de suppression aux boutons

document.addEventListener('DOMContentLoaded', function() {

    document.querySelectorAll('.delete-btn').forEach(function(btn) {

        btn.addEventListener('click', function() {

            var commandeId = this.getAttribute('data-commande-id');

            var clientName = this.getAttribute('data-client-name');

            var commandeDate = this.getAttribute('data-commande-date');

            confirmDelete(commandeId, clientName, commandeDate);

        });

    });

});

</script>

</body>

</html>






    <div class="container">

        <div class="header">

            <h1><i class="fas fa-list"></i> Consulter les Commandes</h1>

            <div>

                <a href="{% url 'enregistrer_commande' %}" class="btn btn-primary">

                    <i class="fas fa-plus"></i> Nouvelle Commande

                </a>

                <a href="{% url 'dashboard_commandes' %}" class="btn btn-secondary">

                    <i class="fas fa-arrow-left"></i> Retour

                </a>

            </div>

        </div>

        <div class="content">

            {% if messages %}

                {% for message in messages %}

                    <div class="alert alert-{{ message.tags }}">

                        {{ message }}

                    </div>

                {% endfor %}

            {% endif %}



            <form method="GET" class="filters">

                <div class="filter-group">

                    <label>Recherche</label>

                    <input type="text" name="search" value="{{ search_query }}" placeholder="Client, article...">

                </div>

                <div class="filter-group">

                    <label>État</label>

                    <select name="etat">

                        <option value="">Tous</option>

                        <option value="en_attente" {% if etat_filter == 'en_attente' %}selected{% endif %}>En attente</option>

                        <option value="en_livraison" {% if etat_filter == 'en_livraison' %}selected{% endif %}>En livraison</option>

                        <option value="livree" {% if etat_filter == 'livree' %}selected{% endif %}>Livrée</option>

                        <option value="annulee" {% if etat_filter == 'annulee' %}selected{% endif %}>Annulée</option>

                    </select>

                </div>

                <div class="filter-group">

                    <label>Date début</label>

                    <input type="date" name="date_debut" value="{{ date_debut }}">

                </div>

                <div class="filter-group">

                    <label>Date fin</label>

                    <input type="date" name="date_fin" value="{{ date_fin }}">

                </div>

                <div class="filter-group" style="display: flex; align-items: flex-end;">

                    <button type="submit" class="btn btn-primary" style="width: 100%;">

                        <i class="fas fa-search"></i> Filtrer

                    </button>

                </div>

            </form>



            {% if commandes %}

            <div style="margin-bottom: 15px; padding: 10px; background: #e7f3ff; border-radius: 5px; color: #0066cc;">

                <strong>Nombre de commandes (documents) affichées: {{ commandes|length }}</strong>

            </div>

            <table>

                <thead>

                    <tr>

                        <th>Date/Heure</th>

                        <th>Client</th>

                        <th>Nombre d'articles</th>

                        <th>Quantité totale</th>

                        <th>Prix total</th>

                        <th>État</th>

                        <th>Actions</th>

                    </tr>

                </thead>

                <tbody>

                    {% for groupe in commandes %}

                    <tr>

                        <td>

                            {{ groupe.date|date:"d/m/Y" }}<br>

                            <small>{{ groupe.heure|time:"H:i" }}</small>

                        </td>

                        <td>{{ groupe.client.intitule }}</td>

                        <td>{{ groupe.nombre_articles }}</td>

                        <td>{{ groupe.quantite_totale|floatformat:2 }}</td>

                        <td>{{ groupe.prix_total|floatformat:0 }} FCFA</td>

                        <td>

                            <span class="badge badge-{% if groupe.etat_commande == 'livree' %}success{% elif groupe.etat_commande == 'annulee' %}danger{% elif groupe.etat_commande == 'en_livraison' %}info{% elif groupe.etat_commande == 'validee' %}success{% else %}warning{% endif %}">

                                {% if groupe.etat_commande == 'en_attente' %}En attente

                                {% elif groupe.etat_commande == 'en_livraison' %}En livraison

                                {% elif groupe.etat_commande == 'livree' %}Livrée

                                {% elif groupe.etat_commande == 'annulee' %}Annulée

                                {% elif groupe.etat_commande == 'validee' %}Validée

                                {% else %}{{ groupe.etat_commande }}{% endif %}

                            </span>

                        </td>

                        <td>

                            <a href="{% url 'detail_commande' groupe.id %}" class="btn btn-info" style="padding: 5px 10px; font-size: 0.85em;">

                                <i class="fas fa-eye"></i> Voir

                            </a>

                            <a href="{% url 'modifier_commande' groupe.id %}" class="btn btn-primary" style="padding: 5px 10px; font-size: 0.85em;">

                                <i class="fas fa-edit"></i> Modifier

                            </a>

                            <button class="btn btn-danger delete-btn" style="padding: 5px 10px; font-size: 0.85em;" 

                                    data-commande-id="{{ groupe.id }}" 

                                    data-client-name="{{ groupe.client.intitule|escapejs }}" 

                                    data-commande-date="{{ groupe.date|date:'d/m/Y' }}">

                                <i class="fas fa-trash"></i> Supprimer

                            </button>

                        </td>

                    </tr>

                    {% endfor %}

                </tbody>

            </table>

            {% else %}

            <div class="empty-state">

                <i class="fas fa-shopping-cart"></i>

                <p>Aucune commande trouvée</p>

            </div>

            {% endif %}

        </div>

    </div>



<!-- Modal de confirmation de suppression -->

<div id="deleteModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; align-items: center; justify-content: center;">

    <div style="background: white; border-radius: 15px; padding: 30px; max-width: 500px; width: 90%; box-shadow: 0 10px 30px rgba(0,0,0,0.3);">

        <h3 style="color: #dc3545; margin-bottom: 15px;">

            <i class="fas fa-exclamation-triangle"></i> Confirmer la suppression

        </h3>

        <p style="margin-bottom: 10px;">Êtes-vous sûr de vouloir supprimer la commande du client <strong id="clientName"></strong> du <strong id="commandeDate"></strong> ?</p>

        <p style="color: #dc3545; font-weight: 600; margin-bottom: 20px;">Cette action est irréversible !</p>

        <div style="display: flex; gap: 10px; justify-content: flex-end;">

            <button onclick="closeDeleteModal()" class="btn btn-secondary" style="padding: 10px 20px;">Annuler</button>

            <form id="deleteForm" method="POST" style="display: inline;">

                {% csrf_token %}

                <button type="submit" class="btn btn-danger" style="padding: 10px 20px;">

                    <i class="fas fa-trash"></i> Supprimer

                </button>

            </form>

        </div>

    </div>

</div>



<script>

function confirmDelete(commandeId, clientName, commandeDate) {

    document.getElementById('clientName').textContent = clientName;

    document.getElementById('commandeDate').textContent = commandeDate;

    document.getElementById('deleteForm').action = "{% url 'supprimer_commande' 0 %}".replace('0', commandeId);

    document.getElementById('deleteModal').style.display = 'flex';

}



function closeDeleteModal() {

    document.getElementById('deleteModal').style.display = 'none';

}



// Fermer le modal en cliquant en dehors

document.getElementById('deleteModal')?.addEventListener('click', function(e) {

    if (e.target === this) {

        closeDeleteModal();

    }

});



// Attacher les événements de suppression aux boutons

document.addEventListener('DOMContentLoaded', function() {

    document.querySelectorAll('.delete-btn').forEach(function(btn) {

        btn.addEventListener('click', function() {

            var commandeId = this.getAttribute('data-commande-id');

            var clientName = this.getAttribute('data-client-name');

            var commandeDate = this.getAttribute('data-commande-date');

            confirmDelete(commandeId, clientName, commandeDate);

        });

    });

});

</script>

</body>

</html>




